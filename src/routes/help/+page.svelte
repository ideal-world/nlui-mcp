<script lang="ts">
  import ExampleCard from './components/ExampleCard.svelte';
  import LayoutExampleCard from './components/LayoutExampleCard.svelte';
  import LanguageSwitcher from '$lib/components/LanguageSwitcher.svelte';
  import ThemeSwitcher from '$lib/components/ThemeSwitcher.svelte';
  import * as m from '../../paraglide/messages';

  // ÂØºÂÖ•ÊâÄÊúâÁªÑ‰ª∂
  import Card from '$lib/ui/components/card.svelte';
  import Table from '$lib/ui/components/table.svelte';
  import Form from '$lib/ui/components/form.svelte';
  import Chart from '$lib/ui/components/chart.svelte';
  import Calendar from '$lib/ui/components/calendar.svelte';
  import Timeline from '$lib/ui/components/timeline.svelte';
  import Gallery from '$lib/ui/components/gallery.svelte';
  import Markdown from '$lib/ui/components/markdown.svelte';
  import Image from '$lib/ui/components/image.svelte';
  import Video from '$lib/ui/components/video.svelte';
  import Audio from '$lib/ui/components/audio.svelte';

  // ÂØºÂÖ•ÊâÄÊúâÁªÑ‰ª∂Á§∫‰æãÊï∞ÊçÆ
  import { getCardExamples } from './examples/cardExamples';
  import { getTableExamples } from './examples/tableExamples';
  import { getFormExamples } from './examples/formExamples';
  import { getChartExamples } from './examples/chartExamples';
  import { getCalendarExamples } from './examples/calendarExamples';
  import { getTimelineExamples } from './examples/timelineExamples';
  import { getGalleryExamples } from './examples/galleryExamples';
  import { getMarkdownExamples } from './examples/markdownExamples';
  import { getImageExamples } from './examples/imageExamples';
  import { getVideoExamples } from './examples/videoExamples';
  import { getAudioExamples } from './examples/audioExamples';
  import { getLayoutExamples } from './examples/layoutExamples';

  const componentSections = [
    {
      id: 'card',
      title: m.doc_component_card_title(),
      description: m.doc_component_card_description(),
      examples: getCardExamples(),
      component: Card
    },
    {
      id: 'table',
      title: m.doc_component_table_title(),
      description: m.doc_component_table_description(),
      examples: getTableExamples(),
      component: Table
    },
    {
      id: 'form',
      title: m.doc_component_form_title(),
      description: m.doc_component_form_description(),
      examples: getFormExamples(),
      component: Form
    },
    {
      id: 'chart',
      title: m.doc_component_chart_title(),
      description: m.doc_component_chart_description(),
      examples: getChartExamples(),
      component: Chart
    },
    {
      id: 'calendar',
      title: m.doc_component_calendar_title(),
      description: m.doc_component_calendar_description(),
      examples: getCalendarExamples(),
      component: Calendar
    },
    {
      id: 'timeline',
      title: m.doc_component_timeline_title(),
      description: m.doc_component_timeline_description(),
      examples: getTimelineExamples(),
      component: Timeline
    },
    {
      id: 'gallery',
      title: m.doc_component_gallery_title(),
      description: m.doc_component_gallery_description(),
      examples: getGalleryExamples(),
      component: Gallery
    },
    {
      id: 'markdown',
      title: m.doc_component_markdown_title(),
      description: m.doc_component_markdown_description(),
      examples: getMarkdownExamples(),
      component: Markdown
    },
    {
      id: 'image',
      title: m.doc_component_image_title(),
      description: m.doc_component_image_description(),
      examples: getImageExamples(),
      component: Image
    },
    {
      id: 'video',
      title: m.doc_component_video_title(),
      description: m.doc_component_video_description(),
      examples: getVideoExamples(),
      component: Video
    },
    {
      id: 'audio',
      title: m.doc_component_audio_title(),
      description: m.doc_component_audio_description(),
      examples: getAudioExamples(),
      component: Audio
    }
  ];
</script>

<div class="from-base-100 via-base-200/30 to-base-300/20 relative min-h-screen bg-gradient-to-br">
  <!-- Âõ∫ÂÆöÂú®È°∂ÈÉ®ÁöÑÁªÑ‰ª∂ÂØºËà™ -->
  <div class="bg-base-100/95 border-base-300/50 fixed top-0 right-0 left-0 z-10 border-b shadow-sm backdrop-blur-md">
    <div class="container mx-auto px-4 py-3">
      <div class="flex items-center justify-between">
        <!-- ÁªÑ‰ª∂ÂØºËà™ÈìæÊé• -->
        <nav class="flex flex-1 flex-wrap justify-center gap-2">
          <!-- Â∏ÉÂ±ÄÁ≥ªÁªüÈìæÊé• -->
          <a href="#layout" class="btn btn-sm btn-primary hover:btn-primary-focus text-xs transition-all duration-200">
            {m.doc_layout_title()}
          </a>
          {#each componentSections as section}
            <a href="#{section.id}" class="btn btn-sm btn-ghost hover:btn-primary text-xs transition-all duration-200">
              {section.title}
            </a>
          {/each}
        </nav>

        <!-- Âè≥‰æßÊéßÂà∂Âå∫Âüü -->
        <div class="ml-4 flex items-center gap-2">
          <LanguageSwitcher />
          <ThemeSwitcher />
        </div>
      </div>
    </div>
  </div>

  <div class="container mx-auto px-4 pt-24 pb-12">
    <!-- È°µÈù¢Ê†áÈ¢òÂíåËØ¥Êòé -->
    <div class="mb-12 text-center">
      <div class="bg-primary/10 mb-6 inline-flex h-20 w-20 items-center justify-center rounded-full">
        <span class="icon-[lucide--book-open] text-primary size-10"></span>
      </div>
      <h1 class="from-primary to-secondary mb-4 bg-gradient-to-r bg-clip-text text-5xl font-bold text-transparent">
        {m.help_title()}
      </h1>
      <p class="text-base-content/80 mx-auto mb-8 max-w-3xl text-xl leading-relaxed">
        {m.help_description()}
      </p>
    </div>

    <!-- ‰ΩøÁî®ËØ¥Êòé -->
    <div class="mx-auto mb-12 max-w-5xl">
      <div class="card from-info/5 to-primary/5 border-info/20 border bg-gradient-to-r shadow-lg">
        <div class="card-body p-6">
          <div class="mb-4 flex items-center gap-3">
            <div class="bg-info/20 flex h-8 w-8 items-center justify-center rounded-lg">
              <span class="icon-[lucide--lightbulb] text-info size-5"></span>
            </div>
            <h2 class="card-title text-info text-xl">{m.help_usage_title()}</h2>
          </div>

          <div class="prose text-base-content max-w-none">
            <p class="text-base-content/80 mb-6 text-base leading-relaxed">{m.help_usage_description()}</p>

            <div class="grid gap-6 md:grid-cols-2">
              <div class="from-base-100 to-base-200/50 border-base-300/30 rounded-xl border bg-gradient-to-br p-5">
                <div class="mb-3 flex items-center gap-2">
                  <span class="icon-[lucide--link] text-primary size-5"></span>
                  <h3 class="text-base-content text-base font-semibold">{m.help_url_params()}</h3>
                </div>
                <p class="text-base-content/70 mb-4 text-sm leading-relaxed">{m.help_url_params_description()}</p>
                <div class="bg-base-300/20 text-base-content border-base-300/30 rounded-lg border p-3 font-mono text-sm break-all">
                  ?nlui={'{'}"showTools":true,"block":{'{'}"main":{'{'}"kind":"card"...{'}'}{'}'}{'}'}
                </div>
              </div>

              <div class="from-base-100 to-base-200/50 border-base-300/30 rounded-xl border bg-gradient-to-br p-5">
                <div class="mb-3 flex items-center gap-2">
                  <span class="icon-[lucide--database] text-secondary size-5"></span>
                  <h3 class="text-base-content text-base font-semibold">{m.help_session_storage()}</h3>
                </div>
                <p class="text-base-content/70 mb-4 text-sm leading-relaxed">{m.help_session_storage_description()}</p>
                <div class="bg-base-300/20 text-base-content border-base-300/30 rounded-lg border p-3 font-mono text-sm">sessionStorage['nluiProp_sessionId']</div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Â∏ÉÂ±ÄÁ≥ªÁªü -->
    <div class="mx-auto mb-12 max-w-7xl">
      <section id="layout" class="scroll-mt-24">
        <div class="card from-base-100/80 to-base-200/30 border-base-300/30 border bg-gradient-to-br shadow-xl backdrop-blur-sm">
          <div class="card-body p-8">
            <!-- Â∏ÉÂ±ÄÊ†áÈ¢òÂå∫Âüü -->
            <div class="mb-8 flex items-start gap-4">
              <div class="bg-primary/20 flex h-16 w-16 flex-shrink-0 items-center justify-center rounded-2xl">
                <span class="icon-[lucide--layout-dashboard] text-primary size-8"></span>
              </div>
              <div class="flex-1">
                <h2 class="text-primary mb-3 text-3xl font-bold">{m.doc_layout_title()}</h2>
                <p class="text-base-content/70 text-lg leading-relaxed">
                  {m.doc_layout_description()}
                </p>
              </div>
            </div>

            <!-- Â∏ÉÂ±ÄÁâπÊÄßËØ¥Êòé -->
            <div class="mb-8 grid gap-4 md:grid-cols-2 lg:grid-cols-4">
              <div class="bg-success/10 border-success/20 text-success rounded-lg border p-4 text-center">
                <span class="icon-[lucide--grid-3x3] mx-auto mb-2 block size-8"></span>
                <h3 class="font-semibold">{m.layout_feature_5_areas()}</h3>
                <p class="mt-1 text-xs opacity-80">{m.layout_feature_5_areas_desc()}</p>
              </div>
              <div class="bg-info/10 border-info/20 text-info rounded-lg border p-4 text-center">
                <span class="icon-[lucide--layers] mx-auto mb-2 block size-8"></span>
                <h3 class="font-semibold">{m.layout_feature_nesting()}</h3>
                <p class="mt-1 text-xs opacity-80">{m.layout_feature_nesting_desc()}</p>
              </div>
              <div class="bg-warning/10 border-warning/20 text-warning rounded-lg border p-4 text-center">
                <span class="icon-[lucide--smartphone] mx-auto mb-2 block size-8"></span>
                <h3 class="font-semibold">{m.layout_feature_responsive()}</h3>
                <p class="mt-1 text-xs opacity-80">{m.layout_feature_responsive_desc()}</p>
              </div>
              <div class="bg-secondary/10 border-secondary/20 text-secondary rounded-lg border p-4 text-center">
                <span class="icon-[lucide--zap] mx-auto mb-2 block size-8"></span>
                <h3 class="font-semibold">{m.layout_feature_performance()}</h3>
                <p class="mt-1 text-xs opacity-80">{m.layout_feature_performance_desc()}</p>
              </div>
            </div>

            <!-- Â∏ÉÂ±ÄÁ§∫‰æã -->
            <div class="space-y-8">
              {#each getLayoutExamples() as example}
                <LayoutExampleCard example={example.config} title={example.title} description={example.description} />
              {/each}
            </div>
          </div>
        </div>
      </section>
    </div>

    <!-- ÁªÑ‰ª∂ÊñáÊ°£ -->
    <div class="mx-auto max-w-7xl space-y-12">
      {#each componentSections as section, index}
        <section id={section.id} class="scroll-mt-24">
          <div class="card from-base-100/80 to-base-200/30 border-base-300/30 border bg-gradient-to-br shadow-xl backdrop-blur-sm">
            <div class="card-body p-8">
              <!-- ÁªÑ‰ª∂Ê†áÈ¢òÂå∫Âüü -->
              <div class="mb-8 flex items-start gap-4">
                <div class="bg-primary/10 flex h-12 w-12 flex-shrink-0 items-center justify-center rounded-xl">
                  <span class="text-2xl">
                    {#if section.id === 'card'}üìÑ
                    {:else if section.id === 'table'}üìä
                    {:else if section.id === 'form'}üìù
                    {:else if section.id === 'chart'}üìà
                    {:else if section.id === 'calendar'}üìÖ
                    {:else if section.id === 'timeline'}üìã
                    {:else if section.id === 'gallery'}üñºÔ∏è
                    {:else if section.id === 'markdown'}üìÑ
                    {:else if section.id === 'image'}üñºÔ∏è
                    {:else if section.id === 'video'}üé•
                    {:else if section.id === 'audio'}üéµ
                    {:else}üîß{/if}
                  </span>
                </div>
                <div class="flex-1">
                  <h2 class="text-primary mb-2 text-3xl font-bold">
                    {section.title}
                  </h2>
                  <p class="text-base-content/80 text-lg leading-relaxed">{section.description}</p>
                </div>
              </div>

              <!-- ÂÆûÊó∂ÁªÑ‰ª∂È¢ÑËßà -->
              <div class="mb-8">
                <div class="mb-6 flex items-center gap-2">
                  <span class="icon-[lucide--eye] text-success size-5"></span>
                  <h3 class="text-base-content text-lg font-semibold">{m.help_live_preview()}</h3>
                  <div class="badge badge-success badge-sm">
                    {Math.min(3, section.examples.length)}
                    {m.help_previews_count()}
                  </div>
                </div>

                <!-- Â§ö‰∏™ÂÆûÊó∂È¢ÑËßà -->
                <div class="grid gap-6 lg:grid-cols-2 xl:grid-cols-3">
                  {#each section.examples.slice(0, 3) as example, idx}
                    <div class="border-base-300/30 bg-base-100/50 overflow-hidden rounded-xl border">
                      <div class="bg-base-200/30 text-base-content/80 border-base-300/30 border-b px-4 py-2 text-sm font-medium">
                        {example.title || `${m.example_number()} ${idx + 1}`}
                      </div>
                      <div class="p-4">
                        {#if section.id === 'table'}
                          <!-- Ë°®Ê†ºÁªÑ‰ª∂ÁâπÊÆäÂ§ÑÁêÜ -->
                          <div class="overflow-x-auto">
                            <svelte:component this={section.component} {...example as any} />
                          </div>
                        {:else if section.id === 'timeline'}
                          <!-- Êó∂Èó¥ËΩ¥ÁªÑ‰ª∂ÈôêÂà∂ÂÆΩÂ∫¶ -->
                          <div class="mx-auto max-w-md">
                            <svelte:component this={section.component} {...example as any} />
                          </div>
                        {:else}
                          <!-- ÂÖ∂‰ªñÁªÑ‰ª∂Ê≠£Â∏∏ÊòæÁ§∫ -->
                          <svelte:component this={section.component} {...example as any} />
                        {/if}
                      </div>
                    </div>
                  {/each}
                </div>
              </div>

              <!-- Á§∫‰æãÂ±ïÁ§∫Âå∫Âüü -->
              <div>
                <div class="mb-6 flex items-center gap-2">
                  <span class="icon-[lucide--layers] text-accent size-5"></span>
                  <h3 class="text-base-content text-lg font-semibold">{m.example_display()}</h3>
                  <div class="badge badge-primary badge-sm">{section.examples.length} {m.examples_count()}</div>
                </div>
                <div class="grid gap-6 md:grid-cols-2 lg:grid-cols-3">
                  {#each section.examples as example}
                    <ExampleCard {example} componentName={section.id} />
                  {/each}
                </div>
              </div>
            </div>
          </div>
        </section>
      {/each}
    </div>

    <!-- È°µËÑö‰ø°ÊÅØ -->
    <div class="border-base-300/30 mt-16 border-t pt-8 text-center">
      <div class="text-base-content/60 mb-2 flex items-center justify-center gap-2">
        <span class="icon-[lucide--heart] size-4"></span>
        <p class="text-sm">NLUI MCP - Natural Language User Interface Framework</p>
      </div>
      <p class="text-base-content/40 text-xs">{m.help_footer_tagline()}</p>
    </div>
  </div>
</div>
